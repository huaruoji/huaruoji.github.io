<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>分类: 动态规划 - 滑蒻稽的博客</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="滑蒻稽的博客"><meta name="msapplication-TileImage" content="/img/positive.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="滑蒻稽的博客"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="滑蒻稽的博客"><meta property="og:url" content="https://huaruoji.github.io/"><meta property="og:site_name" content="滑蒻稽的博客"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://huaruoji.github.io/img/og_image.png"><meta property="article:author" content="huaruoji"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://huaruoji.github.io"},"headline":"滑蒻稽的博客","image":["https://huaruoji.github.io/img/og_image.png"],"author":{"@type":"Person","name":"huaruoji"},"description":""}</script><link rel="icon" href="/img/positive.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="滑蒻稽的博客" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives/">归档</a><a class="navbar-item" href="/categories/">分类</a><a class="navbar-item" href="/tags/">标签</a><a class="navbar-item" href="/about/">关于我</a><a class="navbar-item" href="/%E6%AF%8F%E6%97%A5/">每日</a><a class="navbar-item" href="/%E5%8F%8B%E9%93%BE/">友链</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Huaruoji GitHub" href="https://www.github.com/huaruoji"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">分类</a></li><li class="is-active"><a href="#" aria-current="page">动态规划</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/03/26/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P1896-%5BSCOI2005%5D%E4%BA%92%E4%B8%8D%E4%BE%B5%E7%8A%AF/"><i class="fas fa-angle-double-right"></i>【题解】P1896 [SCOI2005]互不侵犯</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-03-26</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-03-26</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><span> / </span><a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">状态压缩动态规划</a></span><span class="level-item"><i class="far fa-clock"></i> 3 分钟读完 (大约380个字)</span></div></div><div class="content"><h1 id="des">Des</h1>
<p>在N×N的棋盘里面放K个国王，使他们互不攻击，共有多少种摆放方案。国王能攻击到它上下左右，以及左上左下右上右下八个方向上附近的各一个格子，共8个格子。</p>
<h1 id="sol">Sol</h1>
<p>换写法真的很难受啊Orz......不想换写法</p>
<p>所以就自己调了好久,按照广场铺砖差不多的写法写出来了,具体看代码吧<del>应该还是很好懂的</del></p>
<p>谁能想到,调了许久,竟是因为位运算操作错了.</p>
<p>获取某个数的第<code>b</code>位应该用这个:<code>int bit(int a,int b) &#123;return (a&gt;&gt;b)&amp;1;&#125;</code></p></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/">位运算, </a><a class="link-muted" rel="tag" href="/tags/%E7%8A%B6%E5%8E%8BDP/">状压DP, </a><a class="link-muted" rel="tag" href="/tags/%E9%A2%98%E8%A7%A3/">题解, </a><a class="link-muted" rel="tag" href="/tags/%E6%B4%9B%E8%B0%B7/">洛谷 </a></div><a class="article-more button is-small is-size-7" href="/2021/03/26/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P1896-%5BSCOI2005%5D%E4%BA%92%E4%B8%8D%E4%BE%B5%E7%8A%AF/#more"><i class="fas fa-book-reader has-text-grey"></i>  阅读更多</a></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/03/26/%E3%80%90%E4%B8%93%E9%A2%98%E3%80%91%E7%8A%B6%E5%8E%8B-DP/"><i class="fas fa-angle-double-right"></i>【专题】状压 DP</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-03-26</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-03-27</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><span> / </span><a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">状态压缩动态规划</a></span><span class="level-item"><i class="far fa-clock"></i> 3 分钟读完 (大约394个字)</span></div></div><div class="content"><h1 id="前言">前言</h1>
<p>前置知识: 位运算,基础动态规划</p>
<h2 id="位运算的实际运用">位运算的实际运用</h2>
<h3 id="判断第-i-位是否为-0">判断第 i 位是否为 0</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S&amp;(<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>))==<span class="number">0</span></span><br></pre></td></tr></table></figure>
<h3 id="将第-i-位置为-1">将第 i 位置为 1</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S|(<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>))</span><br></pre></td></tr></table></figure>
<h3 id="将第-i-位置为-0">将第 i 位置为 0</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S&amp;~(1&lt;&lt;(i-1))</span><br></pre></td></tr></table></figure>
<h1 id="例题">例题</h1>
<h2 id="poj2411-mondriaans-dream"><a target="_blank" rel="noopener" href="http://poj.org/problem?id=2411">POJ2411 Mondriaan's Dream</a></h2>
<h3 id="des">Des</h3>
<blockquote>
<p>Squares and rectangles fascinated the famous Dutch painter Piet Mondriaan. One night, after producing the drawings in his 'toilet series' (where he had to use his toilet paper to draw on, for all of his paper was filled with squares and rectangles), he dreamt of filling a large rectangle with small rectangles of width 2 and height 1 in varying ways. <img src="https://gitee.com/huaruoji/images/raw/master/img/20210326120204.jpeg" alt="img"> Expert as he was in this material, he saw at a glance that he'll need a computer to calculate the number of ways to fill the large rectangle whose dimensions were integer values, as well. Help him, so that his dream won't turn into a nightmare!</p>
</blockquote>
<p>给出一个W行H列的广场,用1*2小砖铺盖,小砖之间互相不能重叠,问有多少种不同的铺法？</p>
<p>1&lt;=W，H&lt;=11</p>
<h3 id="sol">Sol</h3>
<p>每一行的状态只影响下一行,于是我们可以枚举状态来确定下一行怎么放.具体的操作看其他的题解吧.</p>
<p>这里用的 DFS 其实更适合入门.</p>
<h3 id="my-code">My code</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">20</span>,S=<span class="number">1</span>&lt;&lt;<span class="number">13</span>;</span><br><span class="line"><span class="keyword">int</span> w,h,s;</span><br><span class="line">ll f[N][S];</span><br><span class="line"></span><br><span class="line"><span class="comment">//第i行状态为s1,第i+1行状态为s2,当前在第d列 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> s1,<span class="keyword">int</span> s2,<span class="keyword">int</span> d)</span> </span>&#123; </span><br><span class="line">    <span class="comment">//不同的s1可能推出相同的s2</span></span><br><span class="line">    <span class="comment">//列在d-1结束 </span></span><br><span class="line">    <span class="keyword">if</span>(d==w) &#123;f[i+<span class="number">1</span>][s2]+=f[i][s1];<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="keyword">if</span>((s1&amp;(<span class="number">1</span>&lt;&lt;d))==<span class="number">0</span>) &#123; <span class="comment">//如果s1第d位是0 </span></span><br><span class="line">        dfs(i,s1,s2|(<span class="number">1</span>&lt;&lt;d),d+<span class="number">1</span>);<span class="comment">//将s2的第d位置为1</span></span><br><span class="line">        <span class="keyword">if</span>(d&lt;w<span class="number">-1</span> &amp;&amp; (s1&amp;(<span class="number">1</span>&lt;&lt;(d+<span class="number">1</span>)))==<span class="number">0</span>) &#123; <span class="comment">//如果第d+1位也是0 </span></span><br><span class="line">            dfs(i,s1,s2,d+<span class="number">2</span>); <span class="comment">//横着放,不用管 </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> dfs(i,s1,s2,d+<span class="number">1</span>); <span class="comment">//放不了,也不用管 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;w&gt;&gt;h &amp;&amp; w) &#123;</span><br><span class="line">        s=<span class="number">1</span>&lt;&lt;w;</span><br><span class="line">        <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line">        f[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">1</span>,dfs(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=h;i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;s;j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(f[i][j]) dfs(i,j,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;f[h+<span class="number">1</span>][<span class="number">0</span>]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E4%B8%93%E9%A2%98/">专题, </a><a class="link-muted" rel="tag" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划, </a><a class="link-muted" rel="tag" href="/tags/%E7%8A%B6%E5%8E%8BDP/">状压DP </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/03/23/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P1064-%5BNOIP2006-%E6%8F%90%E9%AB%98%E7%BB%84%5D-%E9%87%91%E6%98%8E%E7%9A%84%E9%A2%84%E7%AE%97%E6%96%B9%E6%A1%88/"><i class="fas fa-angle-double-right"></i>【题解】P1064 [NOIP2006 提高组] 金明的预算方案</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-03-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-03-23</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><span> / </span><a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E8%83%8C%E5%8C%85%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">背包动态规划</a></span><span class="level-item"><i class="far fa-clock"></i> 6 分钟读完 (大约865个字)</span></div></div><div class="content"><h1 id="des">Des</h1>
<p>金明今天很开心，家里购置的新房就要领钥匙了，新房里有一间金明自己专用的很宽敞的房间。更让他高兴的是，妈妈昨天对他说：“你的房间需要购买哪些物品，怎么布置，你说了算，只要不超过 <span class="math inline">\(n\)</span> 元钱就行”。今天一早，金明就开始做预算了，他把想买的物品分为两类：主件与附件，附件是从属于某个主件的，下表就是一些主件与附件的例子：</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">主件</th>
<th style="text-align: center;">附件</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">电脑</td>
<td style="text-align: center;">打印机，扫描仪</td>
</tr>
<tr class="even">
<td style="text-align: center;">书柜</td>
<td style="text-align: center;">图书</td>
</tr>
<tr class="odd">
<td style="text-align: center;">书桌</td>
<td style="text-align: center;">台灯，文具</td>
</tr>
<tr class="even">
<td style="text-align: center;">工作椅</td>
<td style="text-align: center;">无</td>
</tr>
</tbody>
</table>
<p>如果要买归类为附件的物品，必须先买该附件所属的主件。每个主件可以有 <span class="math inline">\(0\)</span> 个、<span class="math inline">\(1\)</span> 个或 <span class="math inline">\(2\)</span> 个附件。每个附件对应一个主件，附件不再有从属于自己的附件。金明想买的东西很多，肯定会超过妈妈限定的 <span class="math inline">\(n\)</span> 元。于是，他把每件物品规定了一个重要度，分为 <span class="math inline">\(5\)</span> 等：用整数 <span class="math inline">\(1 \sim 5\)</span> 表示，第 <span class="math inline">\(5\)</span> 等最重要。他还从因特网上查到了每件物品的价格（都是 <span class="math inline">\(10\)</span> 元的整数倍）。他希望在不超过 <span class="math inline">\(n\)</span> 元的前提下，使每件物品的价格与重要度的乘积的总和最大。</p>
<p>设第 <span class="math inline">\(j\)</span> 件物品的价格为 <span class="math inline">\(v_j\)</span>，重要度为<span class="math inline">\(w_j\)</span>，共选中了 <span class="math inline">\(k\)</span> 件物品，编号依次为 <span class="math inline">\(j_1,j_2,\dots,j_k\)</span>，则所求的总和为：</p>
<p><span class="math inline">\(v_{j_1} \times w_{j_1}+v_{j_2} \times w_{j_2}+ \dots +v_{j_k} \times w_{j_k}\)</span>。</p>
<p>请你帮助金明设计一个满足要求的购物单。</p>
<h1 id="sol">Sol</h1>
<p>有依赖的背包问题.</p>
<p>其实任何有依赖的背包问题都可以转移到树上去做.比如这道题其实完全可以用<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2014">P2014 [CTSC1997]选课</a>的代码写.那道题也可以看作每个课程的重量为 1.</p>
<p>去洛谷本来想看看有没有用<a target="_blank" rel="noopener" href="https://www.kancloud.cn/kancloud/pack/70131">背包九讲</a>里的方法做得,结果根本没有!都是枚举5种情况.好吧Orz.</p>
<p>建树太麻烦,就用一堆乱七八糟的代码过了<img src="https://gitee.com/huaruoji/images/raw/master/img/20210323163333.png" alt="/fad"></p></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划, </a><a class="link-muted" rel="tag" href="/tags/%E9%A2%98%E8%A7%A3/">题解, </a><a class="link-muted" rel="tag" href="/tags/%E6%B4%9B%E8%B0%B7/">洛谷, </a><a class="link-muted" rel="tag" href="/tags/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/">背包问题 </a></div><a class="article-more button is-small is-size-7" href="/2021/03/23/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P1064-%5BNOIP2006-%E6%8F%90%E9%AB%98%E7%BB%84%5D-%E9%87%91%E6%98%8E%E7%9A%84%E9%A2%84%E7%AE%97%E6%96%B9%E6%A1%88/#more"><i class="fas fa-book-reader has-text-grey"></i>  阅读更多</a></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/03/23/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P1273-%E6%9C%89%E7%BA%BF%E7%94%B5%E8%A7%86%E7%BD%91/"><i class="fas fa-angle-double-right"></i>【题解】P1273 有线电视网</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-03-23</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-03-23</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><span> / </span><a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/%E6%B4%9B%E8%B0%B7/">洛谷</a></span><span class="level-item"><i class="far fa-clock"></i> 3 分钟读完 (大约457个字)</span></div></div><div class="content"><h1 id="des">Des</h1>
<p>收费有线电视网计划转播一场重要的足球比赛。他们的转播网和用户终端构成一棵树状结构，这棵树的根结点位于足球比赛的现场，树叶为各个用户终端，其他中转站为该树的内部节点。</p>
<p>从转播站到转播站以及从转播站到所有用户终端的信号传输费用都是已知的，一场转播的总费用等于传输信号的费用总和。</p>
<p>现在每个用户都准备了一笔费用想观看这场精彩的足球比赛，有线电视网有权决定给哪些用户提供信号而不给哪些用户提供信号。</p>
<p>写一个程序找出一个方案使得有线电视网在不亏本的情况下使观看转播的用户尽可能多。</p>
<h1 id="sol">Sol</h1>
<p>树上 DP +分组背包.</p>
<p>用<code>f[i][j]</code>表示第<code>i</code>个节点提供<code>j</code>个用户的费用最小值.时间复杂度<span class="math inline">\(O(n^3)\)</span>.</p>
<p>转移方程为<span class="math inline">\(f[u][j]=max(f[u][j],f[u][j-k]+f[v][k]-w)\)</span>.</p></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划, </a><a class="link-muted" rel="tag" href="/tags/%E9%A2%98%E8%A7%A3/">题解, </a><a class="link-muted" rel="tag" href="/tags/%E6%B4%9B%E8%B0%B7/">洛谷 </a></div><a class="article-more button is-small is-size-7" href="/2021/03/23/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P1273-%E6%9C%89%E7%BA%BF%E7%94%B5%E8%A7%86%E7%BD%91/#more"><i class="fas fa-book-reader has-text-grey"></i>  阅读更多</a></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/03/22/%E3%80%90%E4%B8%93%E9%A2%98%E3%80%91%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"><i class="fas fa-angle-double-right"></i>【专题】树形动态规划</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-03-22</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-03-23</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><span> / </span><a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划</a></span><span class="level-item"><i class="far fa-clock"></i> 7 分钟读完 (大约993个字)</span></div></div><div class="content"><h1 id="简介">简介</h1>
<p>树形动态规划就是在树上进行的动态规划!</p>
<p>由于树的性质,父节点蕴含的信息肯定比子节点多.所以树形 DP 一般递归进行.在求解了子节点对应的子问题后,合并出父节点的信息.</p>
<p>能有树形 DP 解决的问题仍然具有动态规划的一般性质:</p>
<ol type="1">
<li>最优子结构</li>
<li>子问题的重叠性</li>
<li>无后效性</li>
</ol>
<p>题目仍然具有一般动态规划的特征:</p>
<ol type="1">
<li>要求输出的信息是所有可能用到信息的一部分</li>
<li>具有不同的约束条件</li>
</ol>
<p>根据约束条件确定转移状态,状态对应的值是答案信息.</p>
<h1 id="类型">类型</h1>
<h2 id="基础类型约束条件为父亲儿子">基础类型(约束条件为父亲/儿子)</h2>
<p>本类问题很接近树形动态规划的本质.父子节点间相互有联系(其实就是状态).如果你第一次接触树形 DP,想要合适地转移或记录状态,其实比较困难.但好在本类问题的解法比较固定.</p>
<h3 id="p1352-没有上司的舞会"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1352">P1352 没有上司的舞会</a></h3>
<p>父节点选了子节点就不能选,父节点不选子节点就可以选或不选.是否意味着子节点的状态需要由父节点来确定呢?</p>
<p>回顾以前的动态规划,从来就没有这个道理!</p>
<p>其实.每个节点只有2种状态,选,或不选.父节点的状态完全可以从子节点转移过来.所以就有了方程</p>
<p><span class="math inline">\(f[u][0]=r[u]+\sum_{edge(u,v)}f[v][1],f[u][1]=\sum _{edge(u,v)}max(f[v][1],f[v][0])\)</span></p>
<p>最后答案取<span class="math inline">\(max(f[root][0],f[root][1])\)</span>.</p>
<h3 id="sp1437-pt07z---longest-path-in-a-tree"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/SP1437">SP1437 PT07Z - Longest path in a tree</a></h3>
<p>设从根向下遍历的最长长度为<span class="math inline">\(d1\)</span>,次长长度为<span class="math inline">\(d2\)</span>,那么<span class="math inline">\(ans=d1+d2\)</span>.对于每个子树也是这样.满足无后效性(父节点的<span class="math inline">\(d1\)</span>和<span class="math inline">\(d2\)</span>必然从子节点的<span class="math inline">\(d1\)</span>转移得到(可以归纳证明)).</p>
<p>如果<span class="math inline">\(son.d1+son.d2+1&gt;father.d1\)</span>,那么<span class="math inline">\(father.d2=father.d1,father.d1=son.d1+son.d2+1\)</span>.</p>
<p>否则,如果<span class="math inline">\(son.d1+son.d2+1&gt;father.d2\)</span>.那么<span class="math inline">\(father.d2=son.d1+son.d2+1\)</span>.</p>
<h3 id="p2016-战略游戏"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2016">P2016 战略游戏</a></h3>
<p>约束条件为<em>每个节点自己或儿子至少有一个放了士兵</em>.自己放不放完全取决于儿子放没有.</p>
<p><span class="math inline">\(f[u][0]=\sum f[v][1]\\f[u][1]=1+\sum min(f[v][1],f[v][0])\)</span></p>
<h3 id="一本通-5.2-例-5皇宫看守"><a target="_blank" rel="noopener" href="https://loj.ac/p/10157">#10157. 「一本通 5.2 例 5」皇宫看守</a></h3>
<p>上一题的升级版.</p>
<p>本题的约束条件为<em>每个节点的父亲,儿子或自己必须有一个安排了警卫</em>.我们总是首先考虑子节点向父节点的转移方式.不难发现,和子节点被谁看到有关.设<span class="math inline">\(f[u][0],f[u][1],f[u][2]\)</span>分别表示节点被父亲,自己,儿子看到.</p>
<p>那么</p>
<p><span class="math inline">\(f[u][0]=\sum_{edge(u,v)}min(f[v][1],f[v][2]),\)</span></p>
<p><span class="math inline">\(f[u][1]=c[u]+\sum_{edge(u,v)}min(f[v][0],f[v][1],f[v][2]),\)</span></p>
<p><span class="math inline">\(f[u][2]=\sum_{edge(u,v)}min(f[v][1],f[v][2])+d.\)</span></p>
<p>其中<span class="math inline">\(d=min(f[v][2]-min(f[v][1],f[v][2]))\)</span>,保证至少有一个儿子看到.</p>
<h2 id="结合背包约束条件为选择根枝条个数">结合背包(约束条件为选择根/枝条个数)</h2>
<h3 id="p2015-二叉苹果树"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2015">P2015 二叉苹果树</a></h3>
<p>子节点对父节点的依赖在于剩下能保留的枝条数量.但如果运用背包思想加维,就可去除这个依赖,即算出所有子节点可能的状态(不同的保留数量).</p>
<p>本题树为二叉树,具有特殊性质,所以可以用更简单的方法求解(给子节点分配数量).</p>
<h3 id="p2014-ctsc1997选课"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2014">P2014 [CTSC1997]选课</a></h3>
<p>与上一题相似,不在赘述.DP 方程为<span class="math inline">\(f[u][sz]=max(f[u][sz],f[u][sz-k]+f[v][k])\)</span>.</p>
<h3 id="p1273-有线电视网"><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1273">P1273 有线电视网</a></h3>
<p>其实这道题没有约束条件,把每个节点的信息保留好即可.</p>
<p>DP 方程:<span class="math inline">\(f[u][j]=max(f[u][j],f[u][j-k]+f[v][k]-w)\)</span>.</p></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E4%B8%93%E9%A2%98/">专题, </a><a class="link-muted" rel="tag" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划, </a><a class="link-muted" rel="tag" href="/tags/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划 </a></div><a class="article-more button is-small is-size-7" href="/2021/03/22/%E3%80%90%E4%B8%93%E9%A2%98%E3%80%91%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#more"><i class="fas fa-book-reader has-text-grey"></i>  阅读更多</a></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/03/22/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P2016-%E6%88%98%E7%95%A5%E6%B8%B8%E6%88%8F/"><i class="fas fa-angle-double-right"></i>【题解】P2016 战略游戏</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-03-22</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-03-22</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><span> / </span><a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/%E6%B4%9B%E8%B0%B7/">洛谷</a></span><span class="level-item"><i class="far fa-clock"></i> 2 分钟读完 (大约248个字)</span></div></div><div class="content"><h1 id="des">Des</h1>
<p>Bob要建立一个古城堡，城堡中的路形成一棵无根树。他要在这棵树的结点上放置最少数目的士兵，使得这些士兵能了望到所有的路。</p>
<p>注意，某个士兵在一个结点上时，与该结点相连的所有边将都可以被了望到。</p>
<p>请你编一程序，给定一树，帮 Bob 计算出他需要放置最少的士兵。</p>
<h1 id="sol">Sol</h1>
<p>普通树形DP.由子节点的状态决定父节点的状态.如果子节点选,父节点可选课不选.如果子节点不选,父节点必须选.</p></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划, </a><a class="link-muted" rel="tag" href="/tags/%E9%A2%98%E8%A7%A3/">题解, </a><a class="link-muted" rel="tag" href="/tags/%E6%B4%9B%E8%B0%B7/">洛谷 </a></div><a class="article-more button is-small is-size-7" href="/2021/03/22/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P2016-%E6%88%98%E7%95%A5%E6%B8%B8%E6%88%8F/#more"><i class="fas fa-book-reader has-text-grey"></i>  阅读更多</a></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/03/22/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91SP1437-PT07Z---Longest-path-in-a-tree(%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84)/"><i class="fas fa-angle-double-right"></i>【题解】SP1437 PT07Z - Longest path in a tree(树的直径)</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-03-22</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-03-22</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><span> / </span><a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划</a></span><span class="level-item"><i class="far fa-clock"></i> 2 分钟读完 (大约288个字)</span></div></div><div class="content"><h1 id="des">Des</h1>
<p>题目描述 给你一个无权无向的树。编写程序以输出该树中最长路径（从一个节点到另一个节点）的长度。在这种情况下，路径的长度是我们从开始到目的地的遍历边数。</p>
<p>输入输出格式 输入格式： 输入文件的第一行包含一个整数N ---树中的节点数（0 &lt; N &lt;= 10000）。接下来N -1行包含该树的N -1个边---每行包含一对（u，v），表示在节点u和节点v之间存在边（1 &lt;= u，v &lt;= N）。</p>
<p>输出格式： 一行：输出最长路径的长度。</p>
<h1 id="sol">Sol</h1>
<p>经典树的直径,具体解释去<a target="_blank" rel="noopener" href="https://oi-wiki.org/graph/tree-diameter/#_1">OI wiki</a>看吧</p></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E9%A2%98%E8%A7%A3/">题解, </a><a class="link-muted" rel="tag" href="/tags/%E6%B4%9B%E8%B0%B7/">洛谷, </a><a class="link-muted" rel="tag" href="/tags/%E6%A0%91%E8%AE%BA/">树论, </a><a class="link-muted" rel="tag" href="/tags/SPOJ/">SPOJ </a></div><a class="article-more button is-small is-size-7" href="/2021/03/22/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91SP1437-PT07Z---Longest-path-in-a-tree(%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84)/#more"><i class="fas fa-book-reader has-text-grey"></i>  阅读更多</a></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/03/22/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P2014-%5BCTSC1997%5D%E9%80%89%E8%AF%BE/"><i class="fas fa-angle-double-right"></i>【题解】P2014 [CTSC1997]选课</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-03-22</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-03-22</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><span> / </span><a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/%E6%B4%9B%E8%B0%B7/">洛谷</a></span><span class="level-item"><i class="far fa-clock"></i> 2 分钟读完 (大约311个字)</span></div></div><div class="content"><h1 id="des">Des</h1>
<p>在大学里每个学生，为了达到一定的学分，必须从很多课程里选择一些课程来学习，在课程里有些课程必须在某些课程之前学习，如高等数学总是在其它课程之前学习。现在有 <span class="math inline">\(N\)</span> 门功课，每门课有个学分，每门课有一门或没有直接先修课（若课程 a 是课程 b 的先修课即只有学完了课程 a，才能学习课程 b）。一个学生要从这些课程里选择 <span class="math inline">\(M\)</span> 门课程学习，问他能获得的最大学分是多少？</p>
<h1 id="sol">Sol</h1>
<p>本题输入数据为森林,可以用一个虚拟节点作为所有树的根.</p>
<p>和二叉苹果树比较像,本题也有选择节点(边)的数量限制.那么,数量就成了必须保存的信息.用背包的思想转移数量即可.</p></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划, </a><a class="link-muted" rel="tag" href="/tags/%E9%A2%98%E8%A7%A3/">题解, </a><a class="link-muted" rel="tag" href="/tags/%E6%B4%9B%E8%B0%B7/">洛谷 </a></div><a class="article-more button is-small is-size-7" href="/2021/03/22/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P2014-%5BCTSC1997%5D%E9%80%89%E8%AF%BE/#more"><i class="fas fa-book-reader has-text-grey"></i>  阅读更多</a></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/03/20/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P2015-%E4%BA%8C%E5%8F%89%E8%8B%B9%E6%9E%9C%E6%A0%91/"><i class="fas fa-angle-double-right"></i>【题解】P2015 二叉苹果树</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-03-20</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-03-22</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><span> / </span><a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/%E6%B4%9B%E8%B0%B7/">洛谷</a></span><span class="level-item"><i class="far fa-clock"></i> 4 分钟读完 (大约571个字)</span></div></div><div class="content"><h1 id="des">Des</h1>
<p>有一棵苹果树，如果树枝有分叉，一定是分2叉（就是说没有只有1个儿子的结点）</p>
<p>这棵树共有N个结点（叶子点或者树枝分叉点），编号为1-N,树根编号一定是1。</p>
<p>我们用一根树枝两端连接的结点的编号来描述一根树枝的位置。下面是一颗有4个树枝的树 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2   5</span><br><span class="line"> \ &#x2F; </span><br><span class="line">  3   4</span><br><span class="line">   \ &#x2F;</span><br><span class="line">    1</span><br></pre></td></tr></table></figure> 现在这颗树枝条太多了，需要剪枝。但是一些树枝上长有苹果。</p>
<p>给定需要保留的树枝数量，求出最多能留住多少苹果。</p>
<h1 id="sol">Sol</h1>
<p>这道题做得真的是疑惑又头疼......</p>
<p><del>根据个人理解,本题的题面实际上是有些问题的.假设输入数据前后输入了多颗树,最后才把这几颗树连接起来,那么如果不知道父子关系,答案就不唯一.</del></p>
<p><del>洛谷的数据出现了这种情况,但所有数据默认第二个节点是第一个节点的父亲,才没有混淆.所以就有了下面连样例都过不了但是能AC的代码.</del></p>
<p><del>我认为,应该更改题面和样例,确定第二个节点是第一个节点的儿子.或者更改数据,除了输入根,让每次输入的节点至少有一个是之前输入过的.</del></p>
<p>确定了根,答案就是唯一的.只不过我使用的方法并不正确.应该使用邻接表存图,特判父亲.可惜洛谷太水,下面的代码也能过.</p>
<p>回到本题解法.</p>
<p>保留一个节点可以看作是多保留了一些树枝,那么记录树枝数量就可完整保留信息.设将边权转到了儿子上.DP方程为<span class="math inline">\(f[u][j]=f[ls[u]][k]+f[rs[u]][j-k-1]+w[u]\)</span>,</p></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划, </a><a class="link-muted" rel="tag" href="/tags/%E9%A2%98%E8%A7%A3/">题解, </a><a class="link-muted" rel="tag" href="/tags/%E6%B4%9B%E8%B0%B7/">洛谷 </a></div><a class="article-more button is-small is-size-7" href="/2021/03/20/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P2015-%E4%BA%8C%E5%8F%89%E8%8B%B9%E6%9E%9C%E6%A0%91/#more"><i class="fas fa-book-reader has-text-grey"></i>  阅读更多</a></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/03/20/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91P1352-%E6%B2%A1%E6%9C%89%E4%B8%8A%E5%8F%B8%E7%9A%84%E8%88%9E%E4%BC%9A/"><i class="fas fa-angle-double-right"></i>【题解】P1352 没有上司的舞会</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-03-20</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-03-20</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><span> / </span><a class="link-muted" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">树形动态规划</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/%E6%B4%9B%E8%B0%B7/">洛谷</a></span><span class="level-item"><i class="far fa-clock"></i> 4 分钟读完 (大约605个字)</span></div></div><div class="content"><h1 id="des">Des</h1>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1352">P1352 没有上司的舞会 - 洛谷 | 计算机科学教育新生态 (luogu.com.cn)</a></p>
<p>某大学有 <span class="math inline">\(n\)</span> 个职员，编号为 <span class="math inline">\(1\ldots n\)</span>。</p>
<p>他们之间有从属关系，也就是说他们的关系就像一棵以校长为根的树，父结点就是子结点的直接上司。</p>
<p>现在有个周年庆宴会，宴会每邀请来一个职员都会增加一定的快乐指数 <span class="math inline">\(r_i\)</span>，但是呢，如果某个职员的直接上司来参加舞会了，那么这个职员就无论如何也不肯来参加舞会了。</p>
<p>所以，请你编程计算，邀请哪些职员可以使快乐指数最大，求最大的快乐指数。</p>
<h1 id="sol">Sol</h1>
<p>正确做法:</p>
<p>给每个节点安排<code>f[i][0]</code>和<code>f[i][1]</code>.分别表示选择该节点和不选择该节点的 dp 值.</p>
<p><span class="math inline">\(f[u][0]=r[u]+\sum_{edge(u,v)}f[v][1],f[u][1]=\sum _{edge(u,v)}max(f[v][1],f[v][0])\)</span>.</p>
<p>初始调用<code>dp(root,0)</code>和<code>dp(root,1)</code>.当<span class="math inline">\(u\)</span>为叶子节点时抵达边界,不需要特判.</p>
<p>最后答案取<span class="math inline">\(max(f[root][0],f[root][1])\)</span>.</p>
<p>我的错误做法:</p>
<p><del>给每个节点安排<code>f[i][0]</code>和<code>f[i][1]</code>.分别表示选择该节点和不选择该节点的 dp 值.</del></p>
<p><del>递归 dp 中传递 2 个值,一个是当前节点编号 u ,一个是父亲有没有选择(true 表示选择,false 表示不选择).</del></p>
<p><del>若父亲选择了,<span class="math inline">\(f[u][1]=\s