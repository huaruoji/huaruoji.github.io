<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>分类: 数学 - huaruoji</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="huaruoji"><meta name="msapplication-TileImage" content="/img/positive.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="huaruoji"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="huaruoji"><meta property="og:url" content="https://huaruoji.github.io/"><meta property="og:site_name" content="huaruoji"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://huaruoji.github.io/img/og_image.png"><meta property="article:author" content="huaruoji"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://huaruoji.github.io"},"headline":"huaruoji","image":["https://huaruoji.github.io/img/og_image.png"],"author":{"@type":"Person","name":"huaruoji"},"description":""}</script><link rel="icon" href="/img/positive.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="huaruoji" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives/">归档</a><a class="navbar-item" href="/categories/">分类</a><a class="navbar-item" href="/tags/">标签</a><a class="navbar-item" href="/about/">关于我</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Huaruoji GitHub" href="https://www.github.com/huaruoji"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">分类</a></li><li class="is-active"><a href="#" aria-current="page">数学</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/02/03/%E5%BF%AB%E9%80%9F%E5%B9%82(%E5%90%AB%E7%9F%A9%E9%98%B5%E5%BF%AB%E9%80%9F%E5%B9%82)/"><i class="fas fa-angle-double-right"></i>快速幂(含矩阵快速幂)</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-02-03</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-02-21</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/%E5%BF%AB%E9%80%9F%E5%B9%82/">快速幂</a></span><span class="level-item"><i class="far fa-clock"></i> 13 分钟读完 (大约1918个字)</span></div></div><div class="content"><span id="more"></span>

<p><strong>前言:</strong> 矩阵快速幂就是<del>缝合怪</del></p>
<hr>
<h1 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_19782019/article/details/85621386">这篇文章</a>写的真心好啊,%%%.其实在理解其它的算法时,用纸笔推导每一步在干什么,也能达到差不多的理解程度,所以一定要耐心.</p>
<p>首先给一个幂运算:<br>a p a^p ap<br>在代码实现中,实现p次方的复杂度为 O ( p ) O(p) O(p).我们考虑缩减指数,若p是偶数,则 a p = ( a ∗ a ) p 2 a^p=(a*a)^{\frac p 2} ap=(a∗a)2p​.只进行了一次乘法运算,却将指数缩减到了原来的二分之一(这也是为什么快速幂的复杂度是 l o g   n log\ n logn).</p>
<p>有了想法,我们再看能不能实现.由唯一分解定理得:整数 m = ∏ a i p i = ∏ a i 2 k + n = ∏ ( a i 2 k ) 1 ( a i n ) 1 m=\prod a_i^{p_i}=\prod a_i^{2k+n}=\prod (a_i^{2k})^1(a_i^{n})^1 m=∏aipi​​=∏ai2k+n​=∏(ai2k​)1(ain​)1,也就是说,m可分解为若干个幂次为1的数的乘积(好像是废话),那么,在缩减指数的时候,若 p   m o d   2 = = 1 p\ mod \ 2==1 pmod2==1,ans*=a即可.</p>
<p>初步代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">fpm</span><span class="params">(ll a,ll p,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll ans=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(p&gt;<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(p%<span class="number">2</span>==<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			ans=(ans*a)%mod;</span><br><span class="line">		&#125;</span><br><span class="line">		p/=<span class="number">2</span>;</span><br><span class="line">		a=(a*a)%mod; </span><br><span class="line">	&#125;</span><br><span class="line">	ans=(ans*a)%mod;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>优化代码:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">fpm</span><span class="params">(ll a,ll p,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll ans=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(p&gt;=<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(p&amp;<span class="number">1</span>) (ans*=a)%=mod;</span><br><span class="line">		p&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">		(a*=a)%=mod; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>分析while循环,每次做的事为<code>p&gt;&gt;=1</code>和<code>(a*=a)%=mod</code>,结束条件为p&gt;=1,可将其改写为for循环节省行数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">fpm</span><span class="params">(ll a,ll p,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll ans=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,(a*=a)%=mod)</span><br><span class="line">		<span class="keyword">if</span>(p&amp;<span class="number">1</span>) (ans*=a)%=mod; </span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>注意<code>(a*=a)%=mod)</code>是在<code>if(p&amp;1) (ans*=a)%=mod;</code>后执行的.</p>
<h1 id="矩阵快速幂"><a href="#矩阵快速幂" class="headerlink" title="矩阵快速幂"></a>矩阵快速幂</h1><p>矩阵乘法已经在<a target="_blank" rel="noopener" href="https://editor.csdn.net/md/?articleId=113469455">线性代数</a>中提到了.顾名思义,矩阵快速幂用于解决诸如 A p A^p Ap的问题,为什么会用到一个矩阵的幂呢?我们先来回顾斐波那契数列 f n = f n − 1 + f n − 2 f_n=f_{n-1}+f_{n-2} fn​=fn−1​+fn−2​,这个简单的递推式在数据规模为1e7时能轻松通过,但到了1e8便很危险了.这时候矩阵便派上用场了.</p>
<p>斐波那契数列的第n项有通项公式 F n = ( 5 + 1 2 ) n − ( 5 − 1 2 ) n 5 F_n= \frac {(\frac {\sqrt{5}+1} {2})^n-(\frac{\sqrt{5}-1}{2})^n } {\sqrt 5} Fn​=5 ​(25 ​+1​)n−(25 ​−1​)n​,但对精度要求极高,不适用.但我们能不能构造一个类似的通项公式,只不过求出的是一个矩阵呢?</p>
<p>可能你会疑惑,为什么要求一个矩阵呢?请看 [ f n f n − 1 ] \begin{bmatrix}f_n\\f_{n-1}\end{bmatrix} [fn​fn−1​​],这是不是一个矩阵?求出的是不是斐波那契数列?这样,我们的矩阵、快速幂与递推便有机统一了.现在到了在做题时最有思维难度的部分:构造矩阵.<br>思考: [ f [ i ] f [ i − 1 ] ] = [ a b c d ] × [ f [ i − 1 ] f [ i − 2 ] ] \begin{bmatrix}f[i]\\f[i-1]\end{bmatrix}=\begin{bmatrix}a&amp;b\\c&amp;d\end{bmatrix}\times\begin{bmatrix}f[i-1]\\f[i-2]\end{bmatrix} [f[i]f[i−1]​]=[ac​bd​]×[f[i−1]f[i−2]​]<br>第一个矩阵该填什么?首先它肯定是长这个样子的,也就是要找出a,b,c,d满足<br>a × f [ i − 1 ] + b × f [ i − 2 ] = f [ i ] a\times f[i-1]+b\times f[i-2]=f[i] a×f[i−1]+b×f[i−2]=f[i]</p>
<p>c × f [ i − 1 ] + d × f [ i − 2 ] = f [ i − 1 ] c\times f[i-1]+d\times f[i-2]=f[i-1] c×f[i−1]+d×f[i−2]=f[i−1]</p>
<p>c=1,d=2是显然的,a和b等于多少呢?但观察形式,它不就是最基本的斐波那契递推式吗?</p>
<p>于是就有了: f [ i ] = 1 × f [ i − 1 ] + 1 × f [ i − 2 ] (1) \tag 1f[i]=1\times f[i-1]+1\times f[i-2] f[i]=1×f[i−1]+1×f[i−2](1) f [ i − 1 ] = 1 × f [ i − 1 ] + 0 × f [ i − 2 ] (2) \tag 2f[i-1]=1\times f[i-1]+0\times f[i-2] f[i−1]=1×f[i−1]+0×f[i−2](2)<br>由(1)(2)发现式(3)<br>[ f [ i ] f [ i − 1 ] ] = [ 1 1 1 0 ] × [ f [ i − 1 ] f [ i − 2 ] ] (3) \tag 3 \begin{bmatrix}f[i]\\f[i-1]\end{bmatrix}=\begin{bmatrix}1&amp;1\\1&amp;0\end{bmatrix}\times \begin{bmatrix}f[i-1]\\f[i-2]\end{bmatrix} [f[i]f[i−1]​]=[11​10​]×[f[i−1]f[i−2]​](3)<br>ohhhhhhh!构造出来了!剩下的不就简单多了吗,根据式(3)归纳出式(4)<br>[ f [ n + 1 ] f [ n ] ] = [ 1 1 1 0 ] n − 1 × [ f [ 2 ] f [ 1 ] ] (4) \tag 4 \begin{bmatrix}f[n+1]\\f[n]\end{bmatrix}=\begin{bmatrix}1&amp;1\\1&amp;0\end{bmatrix}^{n-1}\times \begin{bmatrix}f[2]\\f[1]\end{bmatrix} [f[n+1]f[n]​]=[11​10​]n−1×[f[2]f[1]​](4)<br>至此,我们已经完成了”构造一个矩阵的通项公式”的任务了,可以编写代码了.</p>
<p>接下来该考虑的事情是如何将矩阵乘法运算套入快速幂,在快速幂的求解中,即将 a p a^p ap拆分成若干个幂次为1的数的乘积,只用到了结合律,显然其对矩阵乘法的运算也是成立的.(其实在这里也满足交换律,毕竟全都是同一个矩阵A).那么我们直接将快速幂中涉及到乘法的部分换为矩阵乘法即可.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fpm_mat</span><span class="params">(matrix &amp;ans,matrix a,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,a.mul(a))</span><br><span class="line">		<span class="keyword">if</span>(p&amp;<span class="number">1</span>) ans.mul(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>封装了一个矩阵板子,支持乘法操作(我居然自己造了一个板子,太不可思议了)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">matrix</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	ll g[N][N];</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(matrix b)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		matrix a;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">				a.g[i][j]=g[i][j],g[i][j]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> s=a.g[i][k];</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">					(g[i][j]+=s*b.g[k][j])%=mod;</span><br><span class="line">			&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3390">P3390 【模板】矩阵快速幂</a></p>
<p>索然无味的AC代码:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">105</span>,mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">ll n,k;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">matrix</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	ll g[N][N];</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(matrix b)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		matrix a;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">				a.g[i][j]=g[i][j],g[i][j]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> s=a.g[i][k];</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">					(g[i][j]+=s*b.g[k][j])%=mod;</span><br><span class="line">			&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fpm_mat</span><span class="params">(matrix &amp;ans,matrix a,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,a.mul(a))</span><br><span class="line">		<span class="keyword">if</span>(p&amp;<span class="number">1</span>) ans.mul(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k;</span><br><span class="line">	matrix a;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;a.g[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	matrix ans;</span><br><span class="line">	<span class="comment">//构造单位矩阵 </span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(i==j) ans.g[i][j]=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">else</span> ans.g[i][j]=<span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fpm_mat(ans,a,k);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;ans.g[i][j]&lt;&lt;<span class="string">&#x27; &#x27;</span>; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里涉及到一个叫做单位矩阵(identity matrix)的东西,就是主对角线上元素全为1的矩阵. I × A = A I\times A=A I×A=A.</p>
<p>好了,回到我们的<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1962">斐波那契数列</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">105</span>,mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">ll n,k;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">matrix</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	ll g[N][N];</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(matrix b,<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		matrix a;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;j++)</span><br><span class="line">				a.g[i][j]=g[i][j],g[i][j]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> s=a.g[i][k];</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;j++)</span><br><span class="line">					(g[i][j]+=s*b.g[k][j])%=mod;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">idt</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2</span>;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">2</span>;j++)</span><br><span class="line">				<span class="keyword">if</span>(i==j) g[i][j]=<span class="number">1</span>;</span><br><span class="line">				<span class="keyword">else</span> g[i][j]=<span class="number">0</span>; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fpm_mat</span><span class="params">(matrix &amp;ans,matrix a,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(;p;p&gt;&gt;=<span class="number">1</span>,a.mul(a,<span class="number">2</span>,<span class="number">2</span>))</span><br><span class="line">		<span class="keyword">if</span>(p&amp;<span class="number">1</span>) ans.mul(a,<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	matrix a,idt;</span><br><span class="line">	idt.idt();</span><br><span class="line">	a.g[<span class="number">1</span>][<span class="number">1</span>]=<span class="number">1</span>,a.g[<span class="number">1</span>][<span class="number">2</span>]=<span class="number">1</span>,a.g[<span class="number">2</span>][<span class="number">1</span>]=<span class="number">1</span>,a.g[<span class="number">2</span>][<span class="number">2</span>]=<span class="number">0</span>;</span><br><span class="line">	fpm_mat(idt,a,n);<span class="comment">//结果存在idt里</span></span><br><span class="line">	matrix f;</span><br><span class="line">	f.g[<span class="number">1</span>][<span class="number">1</span>]=<span class="number">1</span>,f.g[<span class="number">2</span>][<span class="number">1</span>]=<span class="number">1</span>; </span><br><span class="line">	idt.mul(f,<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;idt.g[<span class="number">2</span>][<span class="number">1</span>];</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码虽然AC了,但是因为状态不好,写的<strong>极度糟糕</strong>.</p>
<p>改进了一下板子,增加了idt构造单位矩阵功能:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">matrix</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	ll g[N][N];</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(matrix b,<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		matrix a;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;j++)</span><br><span class="line">				a.g[i][j]=g[i][j],g[i][j]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> s=a.g[i][k];</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;j++)</span><br><span class="line">					(g[i][j]+=s*b.g[k][j])%=mod;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">idt</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">				<span class="keyword">if</span>(i==j) g[i][j]=<span class="number">1</span>;</span><br><span class="line">				<span class="keyword">else</span> g[i][j]=<span class="number">0</span>; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%95%B0%E5%AD%A6/">数学, </a><a class="link-muted" rel="tag" href="/tags/%E7%9F%A9%E9%98%B5/">矩阵, </a><a class="link-muted" rel="tag" href="/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/">快速幂 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/02/02/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/"><i class="fas fa-angle-double-right"></i>乘法逆元</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-02-02</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-02-21</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA/">数论</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/">乘法逆元</a></span><span class="level-item"><i class="far fa-clock"></i> 3 分钟读完 (大约502个字)</span></div></div><div class="content"><span id="more"></span>

<p><strong>前言:</strong> 乘法逆元,一般用于将模意义下的除法转换为乘法</p>
<h1 id="求解普通逆元-a-x-≡-1-m-o-d-m-ax-equiv-1-mod-m-ax≡1-modm"><a href="#求解普通逆元-a-x-≡-1-m-o-d-m-ax-equiv-1-mod-m-ax≡1-modm" class="headerlink" title="求解普通逆元( a x ≡ 1 ( m o d   m ) ax\equiv 1(mod\ m) ax≡1(modm))"></a>求解普通逆元( a x ≡ 1 ( m o d   m ) ax\equiv 1(mod\ m) ax≡1(modm))</h1><h2 id="拓展欧几里得"><a href="#拓展欧几里得" class="headerlink" title="拓展欧几里得"></a>拓展欧几里得</h2><p>首先我们看看逆元的定义:若 a x ≡ 1 ( m o d   m ) ax\equiv 1(mod \ m) ax≡1(modm),且a与m互质,则 x x x为 a a a在 m o d   m mod \ m modm意义下的乘法逆元,记作 a − 1 a^{-1} a−1.</p>
<p>根据这个同余式,我们可以得到 a x + k m = 1 ax+km=1 ax+km=1,且a和m是互质的,那么就满足贝祖等式 a x + b y = g c d ( a , b ) ax+by=gcd(a,b) ax+by=gcd(a,b),可以用拓欧求解.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span><span class="comment">//ax+by</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> ret=exgcd(b,a%b,x,y),t=x;</span><br><span class="line">	x=y,y=t-(a/b)*x;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个板子虽然稍长,但返回值是gcd,用处更广泛</p>
<p>另外,由于gcd求得负数和1最大公约数是-1,<strong>exgcd不能用来求解a为负数的情况</strong></p>
<h2 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h2><p>观察乘法逆元的形式: a x ≡ 1 ( m o d   m ) ax \equiv1(mod \ m) ax≡1(modm).</p>
<p>考虑到欧拉定理: a φ ( m ) ≡ 1 ( m o d   m ) a^{\varphi (m)} \equiv 1(mod\ m) aφ(m)≡1(modm).</p>
<p>由于洛谷模版题中给出m为质数,则有:<br>a x ≡ a m − 1 ( m o d   m ) a ≡ a m − 2 ( m o d   m ) ax \equiv a^{m-1}(mod\ m)\\a \equiv a^{m-2}(mod \ m) ax≡am−1(modm)a≡am−2(modm)<br>那 么 , a 在 m o d   m 意 义 下 的 乘 法 逆 元 即 为 a m − 2 m o d   m 那么,a在mod \ m意义下的乘法逆元即为a^{m-2} mod \ m 那么,a在modm意义下的乘法逆元即为am−2modm,满足快速幂形式,可使用快速幂求解.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">fpm</span><span class="params">(ll x, ll power, ll mod)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x%=mod;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (;power;power&gt;&gt;=<span class="number">1</span>,(x*=x)%=mod)</span><br><span class="line">    	<span class="keyword">if</span>(power&amp;<span class="number">1</span>)(ans*=x)%=mod;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> fpm(x,mod<span class="number">-2</span>,mod);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码中的<code>(ans*=x)%=mod</code>即为<code>(ans=ans*x)=(ans=ans*x)%mod</code>.</p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%95%B0%E5%AD%A6/">数学, </a><a class="link-muted" rel="tag" href="/tags/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/">乘法逆元 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/02/02/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC/"><i class="fas fa-angle-double-right"></i>拉格朗日插值</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-02-02</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-02-21</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/">多项式</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC/">拉格朗日插值</a></span><span class="level-item"><i class="far fa-clock"></i> 7 分钟读完 (大约1084个字)</span></div></div><div class="content"><span id="more"></span>

<p>拉 格 朗 日 插 值 法 可 构 造 一 个 经 过 任 意 n 个 点 ( a 1 , b 1 ) , ( a 2 , b 2 ) , ( a 3 , b 3 ) , … , ( a n , b n ) 的 函 数 f , 设 f = f 1 + f 2 + ⋯ + f n , 需 要 让 f 1 , f 2 , … , f n 均 经 过 这 n 个 点 , 且 当 x = a i 时 , f i = b i ; 当 x = a j ( j ≠ i ) 时 , f i = 0. 拉格朗日插值法可构造一个经过任意n个点(a_1,b_1),(a_2,b_2),(a_3,b_3),\dots,(a_n,b_n)的函数f,设f=f_1+f_2+\dots+f_n,需要让f_1,f_2,\dots,f_n均经过这n个点,且当x=a_i时,f_i=b_i;当x=a_j(j \ne i)时,f_i=0. 拉格朗日插值法可构造一个经过任意n个点(a1​,b1​),(a2​,b2​),(a3​,b3​),…,(an​,bn​)的函数f,设f=f1​+f2​+⋯+fn​,需要让f1​,f2​,…,fn​均经过这n个点,且当x=ai​时,fi​=bi​;当x=aj​(j​=i)时,fi​=0.</p>
<p>那 么 显 然 , 由 f 1 , f 2 , … , f n 相 加 得 到 的 的 f , 恰 好 经 过 了 a 1 , a 2 , … , a n . 那么显然,由f_1,f_2,\dots,f_n相加得到的的f,恰好经过了a_1,a_2,\dots,a_n. 那么显然,由f1​,f2​,…,fn​相加得到的的f,恰好经过了a1​,a2​,…,an​.<br>f 1 , f 2 , … , f n 被 称 为 拉 格 朗 日 基 函 数 , 表 达 式 为 : f i = b i ∏ j ≠ i x − x j x i − x j f_1,f_2,\dots,f_n被称为拉格朗日基函数,表达式为:f_i=b_i\prod_{j\ne i} \frac {x-x_j} {x_i-x_j} f1​,f2​,…,fn​被称为拉格朗日基函数,表达式为:fi​=bi​∏j​=i​xi​−xj​x−xj​​</p>
<p>那 么 , 由 拉 格 朗 日 插 值 法 得 到 的 函 数 f 的 表 达 式 为 : ∑ i = 1 n b i ∏ j ≠ i x − x j x i − x j , 时 间 复 杂 度 为 O ( n 2 ) . 那么,由拉格朗日插值法得到的函数f的表达式为:\sum_{i=1}^{n}b_i\prod_{j\ne i} \frac{x-x_j} {x_i-x_j},时间复杂度为O(n^2). 那么,由拉格朗日插值法得到的函数f的表达式为:∑i=1n​bi​∏j​=i​xi​−xj​x−xj​​,时间复杂度为O(n2).</p>
<p>若 在 程 序 实 现 中 , 每 一 次 计 算 x i − x j 值 时 都 求 一 次 其 的 乘 法 逆 元 , 时 间 复 杂 度 将 乘 上 l o g   n , 我 们 选 择 先 计 算 所 有 x i − x j 的 乘 积 , 再 求 逆 元 . 若在程序实现中,每一次计算x_i-x_j值时都求一次其的乘法逆元,时间复杂度将乘上log\ n,我们选择先计算所有x_i-x_j的乘积,再求逆元. 若在程序实现中,每一次计算xi​−xj​值时都求一次其的乘法逆元,时间复杂度将乘上logn,我们选择先计算所有xi​−xj​的乘积,再求逆元.</p>
<p>另外,此处求逆元必须选择快速幂方法,否则你将陷入深深的迷惑中.为什么呢?在此题中,可能会需要求负数的逆元,但根据辗转相除法求负数和-1的最大公约数时,求得的最大公约数为-1(在cmath库函数__gcd中计算也会得到-1,可见其运用的是辗转相除法).可是在数学定义上,gcd(a,b)=gcd(|a|,|b|),也就是说负数和-1的最大公约数为1.贝祖等式ax+by=gcd(a,b)的gcd(a,b)显然是数学定义上的.那么便不能得到ax+by=1,或者说我们算的其实是ax+by=-1,完全错误了.(我在这个问题上困扰了接近1个小时TAT)</p>
<p>代码:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line">ll n,k,x[<span class="number">2005</span>],y[<span class="number">2005</span>],mod=<span class="number">998244353</span>,ans;<span class="comment">//998244353是个题目常用取模质数 </span></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">fpm</span><span class="params">(ll x,ll power,ll mod)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x %= mod;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; power; power &gt;&gt;= <span class="number">1</span>,(x*=x)%=mod)</span><br><span class="line">    	<span class="keyword">if</span>(power&amp;<span class="number">1</span>) (ans*=x)%=mod;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> fpm(x,mod<span class="number">-2</span>,mod);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;x[i]&gt;&gt;y[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		ll ans_up=y[i],ans_down=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(j==i) <span class="keyword">continue</span>;</span><br><span class="line">			ans_up=(ans_up*(k-x[j]))%mod;</span><br><span class="line">			ans_down=(ans_down*(x[i]-x[j]))%mod;</span><br><span class="line">		&#125;</span><br><span class="line">		ans=(ans+(ans_up*inv(ans_down)))%mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;(ans+mod)%mod&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%95%B0%E5%AD%A6/">数学, </a><a class="link-muted" rel="tag" href="/tags/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC/">拉格朗日插值 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/01/31/P5514%20%5BMtOI2019%5D%E6%B0%B8%E5%A4%9C%E7%9A%84%E6%8A%A5%E5%BA%94/"><i class="fas fa-angle-double-right"></i>P5514 [MtOI2019]永夜的报应</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-01-31</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-02-21</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a><span> / </span><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/%E6%B4%9B%E8%B0%B7/">洛谷</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/%E5%BC%82%E6%88%96/">异或</a></span><span class="level-item"><i class="far fa-clock"></i> 1 分钟读完 (大约192个字)</span></div></div><div class="content"><span id="more"></span>

<p>看了题解才知道这个性质:<br>a ⊕ b ≤ a + b a \oplus b \le a+b a⊕b≤a+b<br><strong>粗略证明</strong>:<br>由<br>0 + 0 = 0 , 0 ⊕ 0 = 0 1 + 0 = 1 , 1 ⊕ 0 = 1 0 + 1 = 1 , 0 ⊕ 1 = 1 1 + 1 = 2 , 1 ⊕ 1 = 0 0+0=0,0\oplus 0=0\\ 1+0=1,1\oplus 0=1\\ 0+1=1,0\oplus 1=1\\ 1+1=2,1\oplus 1=0 0+0=0,0⊕0=01+0=1,1⊕0=10+1=1,0⊕1=11+1=2,1⊕1=0<br>可以得到: a ⊕ b ≤ a + b a \oplus b \le a+b a⊕b≤a+b</p>
<p>回到题目,设分成了2组,得到结果为c,d,原数为 a 1 , a 2 , a 3 , a 4 a_1,a_2,a_3,a_4 a1​,a2​,a3​,a4​,则 c + d = ( a 1 ⊕ a 2 ) + ( a 3 ⊕ a 4 ) ≥ a 1 ⊕ a 2 ⊕ a 3 ⊕ a 4 c + d =(a_1 \oplus a_2)+(a_3 \oplus a_4)\ge a_1 \oplus a_2 \oplus a_3 \oplus a_4 c+d=(a1​⊕a2​)+(a3​⊕a4​)≥a1​⊕a2​⊕a3​⊕a4​</p>
<p>代码:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,ans,p;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;ans;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;p;</span><br><span class="line">		ans=ans^p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E9%A2%98%E8%A7%A3/">题解, </a><a class="link-muted" rel="tag" href="/tags/%E5%BC%82%E6%88%96/">异或, </a><a class="link-muted" rel="tag" href="/tags/%E6%B4%9B%E8%B0%B7/">洛谷 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/01/31/%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95(exgcd)/"><i class="fas fa-angle-double-right"></i>扩展欧几里得算法(exgcd)</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-01-31</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-02-21</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/GCD/">GCD</a></span><span class="level-item"><i class="far fa-clock"></i> 11 分钟读完 (大约1618个字)</span></div></div><div class="content"><span id="more"></span>

<h1 id="欧几里得算法"><a href="#欧几里得算法" class="headerlink" title="欧几里得算法"></a>欧几里得算法</h1><p>首先我们来回顾一下求解2个数的最大公约数(gcd,Greatest Common Divisor)的欧几里得算法:<br>这个算法的核心是 g c d ( a , b ) = g c d ( b , a   m o d   b ) gcd(a,b)=gcd(b,a \ mod \ b) gcd(a,b)=gcd(b,amodb),即 a a a和 b b b的公约数等于 b b b和 a   m o d   b a \ mod \ b amodb的公约数.<br>至于为什么,oi-wiki上有,我们就不证了,但为了理解这个公式,我们举个例子<br>g c d ( 3 , 5 ) = g c d ( 5 , 3 ) = g c d ( 2 , 3 ) = g c d ( 3 , 2 ) = g c d ( 1 , 2 ) = g c d ( 2 , 1 ) = g c d ( 1 , 1 ) = g c d ( 0 , 1 ) = g c d ( 1 , 0 ) gcd(3,5)=gcd(5,3)=gcd(2,3)=gcd(3,2)=\\gcd(1,2)=gcd(2,1)=gcd(1,1)=gcd(0,1)=gcd(1,0) gcd(3,5)=gcd(5,3)=gcd(2,3)=gcd(3,2)=gcd(1,2)=gcd(2,1)=gcd(1,1)=gcd(0,1)=gcd(1,0)<br>然后你会发现,我们将要用1去模0了,但这显然是没有意义的*(a模b的定义为a除以b的余数).并且,1和0是没有公约数的(0没有任何约数),那么我们的程序好像就无法继续进行了.我们又观察到,5和3因为互质,最大公约数是1,恰好是当b=0的时候a的值.那么,其他的数进行gcd操作也会有这样的性质吗?</p>
<p>再来个例子<br>g c d ( 4 , 2 ) = g c d ( 0 , 2 ) = g c d ( 2 , 0 ) gcd(4,2)=gcd(0,2)=gcd(2,0) gcd(4,2)=gcd(0,2)=gcd(2,0)<br>好像确实是这样的!我们只需输出当b等于0时a的值即可!</p>
<p>实际上,当b=0时,就代表着前一步的a%b==0,也就是 b ∣ a b|a b∣a,那么我们的最大公约数显然就是b(下一步的a)了.</p>
<blockquote>
<p>*如果你编译运行<code>1%0</code>这段代码,编译器报错<code>[Warning] division by zero [-Wdiv-by-zero]</code>,程序RE</p>
</blockquote>
<p>这样就可以写出代码:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>) <span class="keyword">return</span> a;</span><br><span class="line">	<span class="keyword">return</span> gcd(b,a%b); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在进入下一部分前,我们先来分析一下这个算法的复杂度.细心的读者已经发现了,上面的例子中有些操作是无效的,他们仅仅交换了a和b的位置,但对于程序运行来说,这是必需的.但他们的数量显然小于等于有效操作的数量,对于时间复杂度的分析来说可以略去.</p>
<p>回顾到取模这个运算,在正数意义下它的代码可以写成这样(你是否知道负数的取模运算?可以参考<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/31344913/answer/51534190">这篇文章</a>):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(a&gt;b) a-=b<span class="comment">//=a%b</span></span><br></pre></td></tr></table></figure>

<p>实际上,G++中实现的取模不是这么简单.具体来说,若 a = q b + r a=qb+r a=qb+r,则 a   m o d   b = r a \ mod \ b=r amodb=r(例:<code>7%(-3)=1</code> <code>-7%(-3)=-1</code> <code>-7%3=-1</code>).并且,G++的原则是使商尽可能大<br><del>有点扯远了,最重要的是知道上面在正数意义下的代码!我们再来举几个例感性理解一下复杂度</del><br>不用感性理解了,请读者们自己思考吧,我直接说结论好了,gcd中的<strong>有效操作</strong>至少能让a减半.</p>
<p>那么,gcd的复杂度就为 l o g   n log \ n logn</p>
<p><strong>补充知识:</strong></p>
<ul>
<li><strong>多个数的最大公约数/最小公倍数求法</strong>:每次取出2个数求得最大公约数/最小公倍数后将最大公约数/最小公倍数放回去</li>
<li><strong>算数基本定理</strong>(用于求lcm,Least Common Multiple,最小公倍数): g c d ( a , b ) × l c m ( a , b ) = a × b gcd(a,b) \times lcm(a,b)=a \times b gcd(a,b)×lcm(a,b)=a×b</li>
</ul>
<h1 id="扩展欧几里德算法-exgcd"><a href="#扩展欧几里德算法-exgcd" class="headerlink" title="扩展欧几里德算法(exgcd)"></a>扩展欧几里德算法(exgcd)</h1><p><del>恶心gcd</del></p>
<blockquote>
<p>扩展欧几里得定理（Extended Euclidean algorithm, EXGCD），常用于求 a x + b y = g c d ( a , b ) ax+by=gcd(a,b) ax+by=gcd(a,b)的一组可行解。</p>
</blockquote>
<p>P.S 原来extra指额外,extend才是扩展…<br><strong>定理:</strong> x 1 = y 2 , y 1 = x 2 − ⌊ a b ⌋ x_1=y_2,y_1=x_2-\lfloor \frac a b \rfloor x1​=y2​,y1​=x2​−⌊ba​⌋<br><strong>证明</strong>(摘自oi-wiki,但手写一遍才能更好的弄懂):</p>
<blockquote>
<p>设<br>a x 1 + b y 1 = gcd ⁡ ( a , b ) ax_1+by_1=\gcd(a,b) ax1​+by1​=gcd(a,b)<br>b x 2 + ( a   m o d   b ) y 2 = gcd ⁡ ( b , a   m o d   b ) bx_2+(a\bmod b)y_2=\gcd(b,a\bmod b) bx2​+(amodb)y2​=gcd(b,amodb)<br>由欧几里得定理可知： gcd ⁡ ( a , b ) = gcd ⁡ ( b , a   m o d   b ) \gcd(a,b)=\gcd(b,a\bmod b) gcd(a,b)=gcd(b,amodb)<br>所以 a x 1 + b y 1 = b x 2 + ( a   m o d   b ) y 2 ax_1+by_1=bx_2+(a\bmod b)y_2 ax1​+by1​=bx2​+(amodb)y2​<br>又因为 a   m o d   b = a − ( ⌊ a b ⌋ × b ) a\bmod b=a-(\lfloor\frac{a}{b}\rfloor\times b) amodb=a−(⌊ba​⌋×b)<br>所以 a x 1 + b y 1 = b x 2 + ( a − ( ⌊ a b ⌋ × b ) ) y 2 ax_1+by_1=bx_2+(a-(\lfloor\frac{a}{b}\rfloor\times b))y_2 ax1​+by1​=bx2​+(a−(⌊ba​⌋×b))y2​<br>a x 1 + b y 1 = a y 2 + b x 2 − ⌊ a b ⌋ × b y 2 = a y 2 + b ( x 2 − ⌊ a b ⌋ y 2 ) ax_1+by_1=ay_2+bx_2-\lfloor\frac{a}{b}\rfloor\times by_2=ay_2+b(x_2-\lfloor\frac{a}{b}\rfloor y_2) ax1​+by1​=ay2​+bx2​−⌊ba​⌋×by2​=ay2​+b(x2​−⌊ba​⌋y2​)<br>因为 a = a , b = b a=a,b=b a=a,b=b ，所以 x 1 = y 2 , y 1 = x 2 − ⌊ a b ⌋ y 2 x_1=y_2,y_1=x_2-\lfloor\frac{a}{b}\rfloor y_2 x1​=y2​,y1​=x2​−⌊ba​⌋y2​</p>
</blockquote>
<p>证明中比较重要的就是这个式子(其实就是取模运算的数学表达式):<br>a   m o d   b = a − ⌊ a b ⌋ × b a \ mod \ b=a-\lfloor \frac a b \rfloor \times b amodb=a−⌊ba​⌋×b<br>知道了 x x x和 y y y的递归表达式,我们就可以进行程序设计了.</p>
<p>既然是递归,就一定有最底层的 x x x和 y y y能够让我们轻易求出值,回到基础gcd算法的递归结束位置, a n o w = g c d ( a , b ) , b n o w = 0 a_{now}=gcd(a,b),b_{now}=0 anow​=gcd(a,b),bnow​=0,带入 a x + b y = g c d ( a , b ) ax+by=gcd(a,b) ax+by=gcd(a,b),得 g c d ( a , b ) × x + 0 × y = g c d ( a , b ) {gcd(a,b)} \times x +0 \times y=gcd(a,b) gcd(a,b)×x+0×y=gcd(a,b)</p>
<p>那么显然 x x x取1, y y y取任意值即可(我们选择取0).</p>
<p>考虑到在源代码上修改,我们仍然返回gcd的值,在过程中计算x和y即可.</p>
<p>代码:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> ret=exgcd(b,a%b,x,y);</span><br><span class="line">	<span class="keyword">int</span> temp=x;</span><br><span class="line">	x=y;</span><br><span class="line">	y=temp-(a/b)*y;</span><br><span class="line">	<span class="keyword">return</span> ret; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%95%B0%E5%AD%A6/">数学, </a><a class="link-muted" rel="tag" href="/tags/GCD/">GCD </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2021/01/31/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"><i class="fas fa-angle-double-right"></i>线性代数</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-01-31</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-02-21</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/">线性代数</a></span><span class="level-item"><i class="far fa-clock"></i> 3 分钟读完 (大约378个字)</span></div></div><div class="content"><span id="more"></span>

<h1 id="向量"><a href="#向量" class="headerlink" title="向量"></a>向量</h1><p><strong>向量</strong>:既有大小又有方向的量<br><strong>向量的三种表示方式</strong>:<br>1.空间中的箭头<br>2. v ⃗ \vec{v} v<br>3. [ 2 3 ] \begin{bmatrix}2\\3\end{bmatrix} [23​]<br><strong>向量的模</strong><br>有向线段 A B → \overrightarrow{AB} AB 的长度叫做 A B AB AB的模,记作| A B → \overrightarrow{AB} AB |或 ∣ a ∣ |a| ∣a∣</p>
<h1 id="矩阵"><a href="#矩阵" class="headerlink" title="矩阵"></a>矩阵</h1><p>例:<br>[ 2 3 4 7 ] \begin{bmatrix}2&amp;3\\4&amp;7\end{bmatrix} [24​37​]<br><strong>矩阵乘法</strong><br>例：<br>设 A = [ 2 3 4 7 ] , B = [ 1 5 6 8 ] , C = A ∗ B 则 C = [ 2 ∗ 1 + 3 ∗ 6 2 ∗ 5 + 3 ∗ 8 4 ∗ 1 + 7 ∗ 6 4 ∗ 5 + 7 ∗ 8 ] = [ 20 34 46 76 ] 设A=\begin{bmatrix}2&amp;3\\4&amp;7\end{bmatrix},B=\begin{bmatrix}1&amp;5\\6&amp;8\end{bmatrix},C=A*B\\ 则C=\begin{bmatrix}2*1+3*6&amp;2*5+3*8\\4*1+7*6&amp;4*5+7*8\end{bmatrix} =\begin{bmatrix}20&amp;34\\46&amp;76\end{bmatrix} 设A=[24​37​],B=[16​58​],C=A∗B则C=[2∗1+3∗64∗1+7∗6​2∗5+3∗84∗5+7∗8​]=[2046​3476​]<br>感性理解：如果把A和B像下面这样标号<br>A = [ 第 一 行 第 二 行 ] , B = [ 第 第 一 二 列 列 ] ， A=\begin{bmatrix}第一行\\第二行\end{bmatrix},B=\begin{bmatrix}第&amp;第\\一&amp;二\\列&amp;列\end{bmatrix}， A=[第一行第二行​],B=⎣⎡​第一列​第二列​⎦⎤​，<br>那么 C = [ 第 一 行 ∗ 第 一 列 第 一 行 ∗ 第 二 列 第 二 行 ∗ 第 一 列 第 二 行 ∗ 第 二 列 ] C=\begin{bmatrix}第一行*第一列&amp;第一行*第二列\\第二行*第一列&amp;第二行*第二列\end{bmatrix} C=[第一行∗第一列第二行∗第一列​第一行∗第二列第二行∗第二列​].<br>此处的行与列相乘理解为<strong>行与列每个对应数乘积之和</strong>,既然要”对应”,那么我们的行宽度与列长度显然要相同.</p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%95%B0%E5%AD%A6/">数学, </a><a class="link-muted" rel="tag" href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/">线性代数 </a></div></div></article></div><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><a class="has-link-black-ter" href="/2019/10/20/%E5%9F%83%E6%B0%8F%E7%B4%A0%E6%95%B0%E7%AD%9B%E6%B3%95(Eratosthenes)/"><i class="fas fa-angle-double-right"></i>埃氏素数筛法(Eratosthenes)</a></h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2019-10-20</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-02-21</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/%E8%B4%A8%E6%95%B0/">质数</a></span><span class="level-item"><i class="far fa-clock"></i> 1 分钟读完 (大约147个字)</span></div></div><div class="content"><span id="more"></span>

<p><strong>埃氏筛法:</strong></p>
<p>对于每一个小于n的非负整数p,删去2p,3p,4p……,当处理完所有数后,还没有删除的就是素数.</p>
<p> </p>
<p>想法:用a记录素数表,a[i]=1表示不是素数,a[i]=0表示是素数.</p>
<p>#include &lt;iostream&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;cmath&gt;</p>
<p>using namespace std;<br>int n,m,a[10000005],t;</p>
<p>int main()<br>{<br>    a[1]=1;<br>    cin&gt;&gt;n&gt;&gt;m;<br>    int pd=sqrt(n+0.5);<br>    for(int i=2;i&lt;=pd;i++) if(!a[i])<br>        for(int j=i*i;j&lt;=n;j+=i) a[j]=1;<br>    // for(int i=1;i&lt;=100;i++)<br>        // cout&lt;&lt;a[i]&lt;&lt;endl;<br>    for(int i=1;i&lt;=m;i++)<br>    {<br>        cin&gt;&gt;t;<br>        if(a[t]==0) cout&lt;&lt;“Yes\n”;<br>        else cout&lt;&lt;“No\n”;<br>    }<br>    return 0;<br>}</p>
<p><strong>注意:1不是素数,需要特判!</strong></p>
<p><strong><img src="https://img2018.cnblogs.com/blog/1839956/201910/1839956-20191020143637148-180335273.png"></strong></p>
<p> </p>
<p> </p>
<p><strong><img src="https://img2018.cnblogs.com/blog/1839956/201910/1839956-20191020143439956-2025172004.png"></strong></p>
</div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E6%95%B0%E5%AD%A6/">数学, </a><a class="link-muted" rel="tag" href="/tags/%E8%B4%A8%E6%95%B0/">质数, </a><a class="link-muted" rel="tag" href="/tags/%E7%AC%94%E8%AE%B0/">笔记 </a></div></div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level" style="margin-bottom:1rem"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-96x96 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.png" alt="滑蒻稽"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">滑蒻稽</p><p class="is-size-6 is-block">这么好的博客不多看两眼吗</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Chengdu, China</span></p></div></div></nav><nav class="level menu-list is-mobile" style="margin-bottom:1rem"><a class="level-item has-text-centered is-marginless" href="/archives/"><div><p class="heading">文章</p><div><p class="title">43</p></div></div></a><a class="level-item has-text-centered is-marginless" href="/categories/"><div><p class="heading">分类</p><div><p class="title">65</p></div></div></a><a class="level-item has-text-centered is-marginless" href="/tags/"><div><p class="heading">标签</p><div><p class="title">50</p></div></div></a></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://www.github.com/huaruoji" target="_blank" rel="noopener"><i class="fab fa-github"></i>  关注我</a></div></div></div><!--!--><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C-%E7%A8%8B%E5%BA%8F/"><span class="tag">C++程序</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CSP/"><span class="tag">CSP</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CSP%E5%88%9D%E8%B5%9B/"><span class="tag">CSP初赛</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GCD/"><span class="tag">GCD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/KMP%E7%AE%97%E6%B3%95/"><span class="tag">KMP算法</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NOI-online/"><span class="tag">NOI online</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NOIP/"><span class="tag">NOIP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/STL/"><span class="tag">STL</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/map/"><span class="tag">map</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vector/"><span class="tag">vector</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/"><span class="tag">乘法逆元</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%88%86%E6%B3%95/"><span class="tag">二分法</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%8F%89%E5%A0%86/"><span class="tag">二叉堆</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/"><span class="tag">位运算</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E6%B2%BB/"><span class="tag">分治</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%9A%E5%AE%A2/"><span class="tag">博客</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%93%88%E5%B8%8C/"><span class="tag">哈希</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE%E8%AE%BA/"><span class="tag">图论</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E5%85%B8%E6%A0%91/"><span class="tag">字典树</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"><span class="tag">字符串</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B0%8F%E8%AE%B0/"><span class="tag">小记</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%82%E6%88%96/"><span class="tag">异或</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/"><span class="tag">快速幂</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BF%AB%E9%80%9F%E8%AF%BB%E5%86%99/"><span class="tag">快速读写</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC/"><span class="tag">拉格朗日插值</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8E%92%E5%BA%8F/"><span class="tag">排序</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%AD%A6/"><span class="tag">数学</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="tag">数据结构</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/"><span class="tag">最小生成树</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A8%A1%E7%89%88/"><span class="tag">模版</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%AF%94%E8%B5%9B/"><span class="tag">比赛</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B4%9B%E8%B0%B7/"><span class="tag">洛谷</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B8%B8%E8%AE%B0/"><span class="tag">游记</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%9F%A9%E9%98%B5/"><span class="tag">矩阵</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%9F%A9%E9%98%B5%E5%BF%AB%E9%80%9F%E5%B9%82/"><span class="tag">矩阵快速幂</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AC%94%E8%AE%B0/"><span class="tag">笔记</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/"><span class="tag">算法</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%A6%E7%91%9F%E5%A4%AB%E9%97%AE%E9%A2%98/"><span class="tag">约瑟夫问题</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%BF%E6%80%A7DP/"><span class="tag">线性DP</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"><span class="tag">线性代数</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AF%AD%E6%B3%95/"><span class="tag">语法</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B4%A8%E6%95%B0/"><span class="tag">质数</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B5%84%E6%BA%90/"><span class="tag">资源</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BD%AF%E4%BB%B6/"><span class="tag">软件</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%80%92%E6%8E%A8/"><span class="tag">递推</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%93%BE%E8%A1%A8/"><span class="tag">链表</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"><span class="tag">面向对象</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%A2%98%E8%A7%A3/"><span class="tag">题解</span><span class="tag">5</span></a></div></div></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">二月 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">一月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">十二月 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">十一月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/10/"><span class="level-start"><span class="level-item">十月 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/C/"><span class="level-start"><span class="level-item">C++</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/C/%E4%BD%8D%E8%BF%90%E7%AE%97/"><span class="level-start"><span class="level-item">位运算</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/C/%E8%AF%AD%E6%B3%95/"><span class="level-start"><span class="level-item">语法</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/C/%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">语言</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/C/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"><span class="level-start"><span class="level-item">面向对象</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/STL/"><span class="level-start"><span class="level-item">STL</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/STL/algorithm/"><span class="level-start"><span class="level-item">algorithm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/STL/map/"><span class="level-start"><span class="level-item">map</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/STL/vector/"><span class="level-start"><span class="level-item">vector</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"><span class="level-start"><span class="level-item">动态规划</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%BA%BF%E6%80%A7%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"><span class="level-start"><span class="level-item">线性动态规划</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E5%8D%A1%E5%B8%B8-%E4%BC%98%E5%8C%96/"><span class="level-start"><span class="level-item">卡常+优化</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E5%8D%A1%E5%B8%B8-%E4%BC%98%E5%8C%96/%E8%AF%BB%E5%86%99%E7%9B%B8%E5%85%B3/"><span class="level-start"><span class="level-item">读写相关</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">听课笔记</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/SSZX/"><span class="level-start"><span class="level-item">SSZX</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E5%9B%BE%E8%AE%BA/"><span class="level-start"><span class="level-item">图论</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E5%9B%BE%E8%AE%BA/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/"><span class="level-start"><span class="level-item">最小生成树</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/"><span class="level-start"><span class="level-item">基础算法</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/%E5%93%88%E5%B8%8C/"><span class="level-start"><span class="level-item">哈希</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F/"><span class="level-start"><span class="level-item">排序</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/%E9%80%92%E6%8E%A8/"><span class="level-start"><span class="level-item">递推</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/"><span class="level-start"><span class="level-item">字符串</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/KMP%E7%AE%97%E6%B3%95/"><span class="level-start"><span class="level-item">KMP算法</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/%E5%AD%97%E5%85%B8%E6%A0%91/"><span class="level-start"><span class="level-item">字典树</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E5%B0%8F%E8%AE%B0/"><span class="level-start"><span class="level-item">小记</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E5%B0%8F%E8%AE%B0/OI%E5%8E%86%E7%A8%8B/"><span class="level-start"><span class="level-item">OI历程</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B0%8F%E8%AE%B0/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"><span class="level-start"><span class="level-item">博客搭建</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B0%8F%E8%AE%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><span class="level-start"><span class="level-item">操作系统</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B0%8F%E8%AE%B0/%E7%BB%8F%E9%AA%8C/"><span class="level-start"><span class="level-item">经验</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B0%8F%E8%AE%B0/%E8%BD%AF%E4%BB%B6/"><span class="level-start"><span class="level-item">软件</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/"><span class="level-start"><span class="level-item">数学</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/GCD/"><span class="level-start"><span class="level-item">GCD</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"><span class="level-start"><span class="level-item">多项式</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC/"><span class="level-start"><span class="level-item">拉格朗日插值</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/%E5%BC%82%E6%88%96/"><span class="level-start"><span class="level-item">异或</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/%E5%BF%AB%E9%80%9F%E5%B9%82/"><span class="level-start"><span class="level-item">快速幂</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA/"><span class="level-start"><span class="level-item">数论</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/"><span class="level-start"><span class="level-item">乘法逆元</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"><span class="level-start"><span class="level-item">线性代数</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/%E8%B4%A8%E6%95%B0/"><span class="level-start"><span class="level-item">质数</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="level-start"><span class="level-item">数据结构</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%91%E5%BD%A2%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="level-start"><span class="level-item">树形数据结构</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%91%E5%BD%A2%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%A0%86/"><span class="level-start"><span class="level-item">堆</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%91%E5%BD%A2%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%AD%97%E5%85%B8%E6%A0%91/"><span class="level-start"><span class="level-item">字典树</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="level-start"><span class="level-item">线性数据结构</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E9%93%BE%E8%A1%A8/"><span class="level-start"><span class="level-item">链表</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%9D%82%E9%A1%B9/"><span class="level-start"><span class="level-item">杂项</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%9D%82%E9%A1%B9/%E5%89%8D%E5%90%8E%E4%B8%AD%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F/"><span class="level-start"><span class="level-item">前后中缀表达式</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%9D%82%E9%A1%B9/%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">工具</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%AF%94%E8%B5%9B/"><span class="level-start"><span class="level-item">比赛</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%AF%94%E8%B5%9B/CSP/"><span class="level-start"><span class="level-item">CSP</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%AF%94%E8%B5%9B/%E5%85%B6%E4%BB%96/"><span class="level-start"><span class="level-item">其他</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%AF%94%E8%B5%9B/%E6%A0%A1%E5%86%85%E6%B5%8B/"><span class="level-start"><span class="level-item">校内测</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E8%B5%84%E6%BA%90/"><span class="level-start"><span class="level-item">资源</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E8%B5%84%E6%BA%90/%E6%88%90%E7%BB%A9/"><span class="level-start"><span class="level-item">成绩</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B5%84%E6%BA%90/%E9%A2%98%E5%8D%95/"><span class="level-start"><span class="level-item">题单</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B5%84%E6%BA%90/%E9%A2%98%E7%9B%AE/"><span class="level-start"><span class="level-item">题目</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E8%B5%9B%E5%89%8D/"><span class="level-start"><span class="level-item">赛前</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E8%B5%9B%E5%89%8D/CSP%E5%88%9D%E8%B5%9B/"><span class="level-start"><span class="level-item">CSP初赛</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E9%A2%98%E8%A7%A3/"><span class="level-start"><span class="level-item">题解</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E9%A2%98%E8%A7%A3/CSP-S/"><span class="level-start"><span class="level-item">CSP-S</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E9%A2%98%E8%A7%A3/CSP-S/2019/"><span class="level-start"><span class="level-item">2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E9%A2%98%E8%A7%A3/XCSY/"><span class="level-start"><span class="level-item">XCSY</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%A2%98%E8%A7%A3/%E6%A0%A1%E5%86%85%E6%B5%8B/"><span class="level-start"><span class="level-item">校内测</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%A2%98%E8%A7%A3/%E6%B4%9B%E8%B0%B7/"><span class="level-start"><span class="level-item">洛谷</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2021/02/21/hello-world/"><img src="/img/thumbnail.svg" alt="Hello,Hexo!"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-02-21T12:03:00.000Z">2021-02-21</time></p><p class="title"><a href="/2021/02/21/hello-world/">Hello,Hexo!</a></p><p class="categories"><a href="/categories/%E5%B0%8F%E8%AE%B0/">小记</a> / <a href="/categories/%E5%B0%8F%E8%AE%B0/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/">博客搭建</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/02/21/%E5%90%AC%E8%AF%BE%E8%AE%B0%E5%BD%95%20210220%E3%80%90%E5%88%86%E6%B2%BB,%E6%A0%91%E5%88%86%E6%B2%BB,CDQ%E5%88%86%E6%B2%BB%E3%80%91/"><img src="/img/thumbnail.svg" alt="听课记录 210220【分治,树分治,CDQ分治】"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-02-21T05:20:27.000Z">2021-02-21</time></p><p class="title"><a href="/2021/02/21/%E5%90%AC%E8%AF%BE%E8%AE%B0%E5%BD%95%20210220%E3%80%90%E5%88%86%E6%B2%BB,%E6%A0%91%E5%88%86%E6%B2%BB,CDQ%E5%88%86%E6%B2%BB%E3%80%91/">听课记录 210220【分治,树分治,CDQ分治】</a></p><p class="categories"><a href="/categories/%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/">听课笔记</a> / <a href="/categories/%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/SSZX/">SSZX</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/02/21/%E6%B4%9B%E8%B0%B7%E8%83%BD%E5%8A%9B%E8%BF%9B%E9%98%B6%E6%8F%90%E5%8D%87%E9%A2%98%E5%8D%95--%E4%B8%AA%E4%BA%BA%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"><img src="/img/thumbnail.svg" alt="洛谷能力进阶提升题单--个人刷题记录"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-02-21T01:22:53.000Z">2021-02-21</time></p><p class="title"><a href="/2021/02/21/%E6%B4%9B%E8%B0%B7%E8%83%BD%E5%8A%9B%E8%BF%9B%E9%98%B6%E6%8F%90%E5%8D%87%E9%A2%98%E5%8D%95--%E4%B8%AA%E4%BA%BA%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/">洛谷能力进阶提升题单--个人刷题记录</a></p><p class="categories"><a href="/categories/%E8%B5%84%E6%BA%90/">资源</a> / <a href="/categories/%E8%B5%84%E6%BA%90/%E9%A2%98%E5%8D%95/">题单</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/02/17/%E9%87%8D%E8%AF%BBC++%20Primer%20Plus/"><img src="/img/thumbnail.svg" alt="重读C++ Primer Plus"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-02-17T08:18:05.000Z">2021-02-17</time></p><p class="title"><a href="/2021/02/17/%E9%87%8D%E8%AF%BBC++%20Primer%20Plus/">重读C++ Primer Plus</a></p><p class="categories"><a href="/categories/C/">C++</a> / <a href="/categories/C/%E8%AF%AD%E8%A8%80/">语言</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/02/05/Contest%20210205/"><img src="/img/thumbnail.svg" alt="Contest 210205"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-02-05T08:36:36.000Z">2021-02-05</time></p><p class="title"><a href="/2021/02/05/Contest%20210205/">Contest 210205</a></p><p class="categories"><a href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a> / <a href="/categories/%E6%AF%94%E8%B5%9B/%E6%A0%A1%E5%86%85%E6%B5%8B/">校内测</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="huaruoji" height="28"></a><p class="is-size-7"><span>&copy; 2021 huaruoji</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><i class="fab fa-creative-commons"></i> <i class="fab fa-creative-commons-by"></i> <i class="fab fa-creative-commons-nc"></i> <i class="fab fa-creative-commons-sa"></i> </a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="huaruoji GitHub" href="https://www.github.com/huaruoji"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.css"><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/auto-render.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>